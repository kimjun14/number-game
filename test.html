<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>1~999 ìˆ«ì ì°¾ê¸°</title>
  <style>
    body {
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    #condition {
      margin-bottom: 10px;
      font-size: 1.2em;
    }
    #timer, #score, #bestScore {
      margin-bottom: 10px;
      font-size: 1.1em;
    }
    #grid {
      display: grid;
      grid-template-columns: repeat(10, 1fr);
      gap: 6px;
      width: 100%;
      max-width: 600px;
      margin-bottom: 20px;
    }
    .cell {
      padding: 12px 0;
      text-align: center;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: #f9f9f9;
      cursor: pointer;
      user-select: none;
      transition: background 0.2s, color 0.2s;
    }
    .cell.correct {
      background: #c8e6c9;
      color: #256029;
      cursor: default;
    }
    .cell.wrong {
      background: #ffcdd2;
      color: #b71c1c;
      cursor: default;
    }
    #finalMessage {
      font-size: 1.3em;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div id="condition">ì¡°ê±´: â€¦</div>
  <div id="timer">ë‚¨ì€ ì‹œê°„: <span id="time">60</span>ì´ˆ</div>
  <div id="score">í˜„ì¬ ì ìˆ˜: 0</div>
  <div id="bestScore">ìµœê³  ê¸°ë¡: 0</div>
  <div id="grid"></div>
  <div id="finalMessage"></div>

  <script>
    // 1) ì¡°ê±´ í•¨ìˆ˜ ëª©ë¡ê³¼ ì„¤ëª… (ì´ 20ê°œ)
    const conditions = [
      { test: n => n % 2 === 0, desc: 'ì§ìˆ˜' },
      { test: n => n % 3 === 0, desc: '3ì˜ ë°°ìˆ˜' },
      { test: n => n % 5 === 0, desc: '5ì˜ ë°°ìˆ˜' },
      { test: n => (''+n).includes('7'), desc: '7 í¬í•¨' },
      { test: n => (''+n).split('').map(Number).reduce((a,b)=>a+b,0) === 10, desc: 'ìˆ«ì í•©ì´ 10' },
      { test: n => n > 500, desc: '500 ì´ˆê³¼' },
      { test: n => n < 250, desc: '250 ë¯¸ë§Œ' },
      { test: n => String(n) === String(n).split('').reverse().join(''), desc: 'íšŒë¬¸ìˆ˜' },
      { test: n => Math.sqrt(n)%1 === 0, desc: 'ì •ìˆ˜ ì œê³±ìˆ˜' },
      { test: n => n % 10 === 5, desc: 'ëìë¦¬ 5' },
      { test: n => n % 11 === 0, desc: '11ì˜ ë°°ìˆ˜' },
      { test: n => (''+n).split('').filter(d=>d==='3').length >=1, desc: '3ì´ í•˜ë‚˜ ì´ìƒ' },
      { test: n => n % (n%10 + 1) === 0, desc: 'ëìë¦¬+1ë¡œ ë‚˜ëˆ„ì–´ì§' },
      { test: n => (''+n).length === 3, desc: '3ìë¦¬ ìˆ«ì' },
      { test: n => n === [...String(n)].map(Number).sort((a,b)=>a-b).join('')*1, desc: 'ì˜¤ë¦„ì°¨ìˆœ' },
      { test: n => [...Set(String(n))].length === 1, desc: 'ëª¨ë‘ ê°™ì€ ìˆ«ì' },
      { test: n => n % 7 === 0, desc: '7ì˜ ë°°ìˆ˜' },
      { test: n => (''+n).endsWith('0'), desc: '0ìœ¼ë¡œ ëë‚¨' },
      { test: n => [...String(n)].map(Number).reduce((a,b)=>a*b,1) > 50, desc: 'ìë¦¬ ê³± >50' },
      { test: n => n % 9 === 0, desc: '9ì˜ ë°°ìˆ˜' }
    ];

    let currentCondIndex = 0;
    let score = 0;
    let timeLeft = 60;
    let timerId;

    // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì—ì„œ ìµœê³  ê¸°ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
    const bestScore = localStorage.getItem('bestScore') || 0;
    document.getElementById('bestScore').textContent = `ìµœê³  ê¸°ë¡: ${bestScore}`;

    // ìˆ«ì ìƒ˜í”Œë§
    function sampleNumbers(count, max) {
      const set = new Set();
      while (set.size < count) set.add(Math.floor(Math.random() * max) + 1);
      return [...set];
    }

    // ê·¸ë¦¬ë“œ ë Œë”
    function renderGrid() {
      const gridEl = document.getElementById('grid');
      gridEl.innerHTML = '';
      sampleNumbers(50, 999).forEach(n => {
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.textContent = n;
        cell.addEventListener('click', () => onCellClick(cell, n));
        gridEl.appendChild(cell);
      });
    }

    // ì…€ í´ë¦­
    function onCellClick(cellEl, num) {
      if (cellEl.classList.contains('correct') || cellEl.classList.contains('wrong') || timeLeft<=0) return;
      const cond = conditions[currentCondIndex];
      if (cond.test(num)) {
        cellEl.textContent = 'O';
        cellEl.classList.add('correct');
        score++;
        updateScore();
        if (score % 10 === 0) setTimeout(showCondition, 300);
      } else {
        cellEl.textContent = 'X';
        cellEl.classList.add('wrong');
      }
    }

    // ì ìˆ˜ ì—…ë°ì´íŠ¸
    function updateScore() {
      document.getElementById('score').textContent = `í˜„ì¬ ì ìˆ˜: ${score}`;
    }

    // ì¡°ê±´ ë° ê·¸ë¦¬ë“œ ì´ˆê¸°í™”
    function showCondition() {
      currentCondIndex = Math.floor(Math.random() * conditions.length);
      document.getElementById('condition').textContent = `ì¡°ê±´: ${conditions[currentCondIndex].desc}`;
      renderGrid();
    }

    // íƒ€ì´ë¨¸ ì‹œì‘
    function startTimer() {
      timerId = setInterval(() => {
        if (timeLeft <= 0) return endGame();
        timeLeft--;
        document.getElementById('time').textContent = timeLeft;
      }, 1000);
    }

    // ê²Œì„ ì¢…ë£Œ
    function endGame() {
      clearInterval(timerId);
      document.getElementById('finalMessage').textContent =
        `ì‹œê°„ ì¢…ë£Œ! ìµœì¢… ì ìˆ˜: ${score}`;
      // ìµœê³  ê¸°ë¡ ê°±ì‹ 
      const prev = localStorage.getItem('bestScore') || 0;
      if (score > prev) {
        localStorage.setItem('bestScore', score);
        document.getElementById('bestScore').textContent = `ìµœê³  ê¸°ë¡: ${score}`;
        document.getElementById('finalMessage').textContent += ' ğŸ‰ ìƒˆë¡œìš´ ê¸°ë¡!';
      }
    }

    // ì´ˆê¸°í™”
    window.addEventListener('DOMContentLoaded', () => {
      showCondition();
      startTimer();
    });
  </script>
</body>
</html>
